<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How To: Alter MEND 2013 microbial kinetics • MENDplus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How To: Alter MEND 2013 microbial kinetics">
<meta property="og:description" content="MENDplus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MENDplus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MEND2013.html">How To: Set up and solve MEND from Wang et al. 2013</a>
    </li>
    <li>
      <a href="../articles/MEND2013_change_kinetics.html">How To: Alter MEND 2013 microbial kinetics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MEND2013_change_kinetics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How To: Alter MEND 2013 microbial kinetics</h1>
            
      
      
      <div class="hidden name"><code>MEND2013_change_kinetics.Rmd</code></div>

    </div>

    
    
<div id="objective-background" class="section level2">
<h2 class="hasAnchor">
<a href="#objective-background" class="anchor"></a>Objective &amp; Background</h2>
<p>The goal of <code>MENDplus</code> is to provide user with a flexible framework that to explore how parametric and structural uncertainty impact mircobical soil carbon dynamics. This vignette deomonstrates how changes can be made to explore what happens to model output when the model structure changes. Below is a modified conceptual diagram of MEND from <a href="https://doi.org/10.1890/12-0681.1">Wang et al. 2013</a>. There is a red cicle around arrow (1) which represents the carbon flux between the dissolved organic carbon (DOC) and the carbon microbial biomass (MBC). In the <a href="https://doi.org/10.1890/12-0681.1">Wang et al. 2013</a> this flux is modeled with the Michaelis-Menten kinetics (MM) which we will replace with reverse Michaelis–Menten kinetics (R-MM).</p>
<div class="figure">
<img src="https://user-images.githubusercontent.com/27299759/93517321-4cf6a880-f8f9-11ea-8aa8-90013d10a07e.png" style="width:70.0%" alt=""><p class="caption">Fig 1: modified conceptual diagram of MEND from Wang et al. 2013</p>
</div>
<p><br><br></p>
<div class="figure">
<img src="https://esajournals.onlinelibrary.wiley.com/cms/asset/acddee9d-24a9-4aa8-be75-86388c52e091/eap2013231255-math-0009.gif" alt=""><p class="caption">Eq 1: equation for the the flux D to B from Wang et al 2013.</p>
</div>
<p>Equation 1 corresponds to <span class="math inline">\(F_{1}\)</span> (the arrow circled in red in Fig 1), it uses M-M kinetics to model the flux between DOC and microbial biomass. This implies the microbial biomass only depends on the availability of DOC and independent on the density of the microbial biomass (competition, waste, etc.) however these can be incorporated into the flux via a R-M-M kinetics representation. Modified <span class="math inline">\(F_{1}\)</span> will look like (eq 2):</p>
<p><span class="math display">\[F_{1} = \frac{1}{E_c}({V}_{d}*{m}_{r})\frac{D * B }{{K}_{d} + B}\]</span></p>
<p><br></p>
</div>
<div id="solve-default-mend-2013" class="section level2">
<h2 class="hasAnchor">
<a href="#solve-default-mend-2013" class="anchor"></a>Solve Default MEND 2013</h2>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">MENDplus</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
</pre></div>
<p>Start with solving MEND with the Wang et al. 2013 paper settings.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Define the size of the different MEND 2013 carbon pools. </span>
<span class="kw">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(P = <span class="fl">10</span>,  M = <span class="fl">5</span>,  Q = <span class="fl">0.1</span>,  B = <span class="fl">2</span>,  D = <span class="fl">1</span>,  EP = <span class="fl">0.00001</span>, EM = <span class="fl">0.00001</span>,  IC = <span class="fl">0</span>,  Tot = <span class="fl">18.10002</span>)

<span class="co"># Define a table of MEND parameters. # MENDplus containts a dataframe of the default parameter values from Wang et al. 2013.</span>
<span class="kw">param</span> <span class="op">&lt;-</span> <span class="kw">MENDplus</span>::<span class="kw"><a href="../reference/MEND2013_params.html">MEND2013_params</a></span>

<span class="kw">MEND2013_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solver.html">solver</a></span>(params = <span class="kw">param</span>, 
                           time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1e3</span>, by = <span class="fl">0.1</span>), 
                           state = <span class="kw">state</span>, 
                           carbon_pools_func = <span class="kw">MEND2013_pools</span>, 
                           carbon_fluxes_func = <span class="kw">MEND2013_fluxes</span>)
</pre></div>
</div>
<div id="implementing-r-m-m-with-mendplus" class="section level2">
<h2 class="hasAnchor">
<a href="#implementing-r-m-m-with-mendplus" class="anchor"></a>Implementing R-M-M with <code>MENDplus</code>
</h2>
<p>To incorperate the R-M-M kinetic dynamics we will have to modify the carbon flux functions. There are lots of different ways to do this. We will used the <code>modify_fluxes_func</code> to replace the M-M F1 with the R-M-M F1.</p>
<p>First create a list containing the new F1 function, this function will replace D with B in the denominator, to convert F1 from M-M kinetics as in equation 1 to R-M-M kinetics as in equation 2.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">new_func_list</span> <span class="op">&lt;-</span> <span class="fu">function</span>(){
  
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">'F1'</span> = <span class="fu">function</span>(){
        <span class="co"># DOC uptake by microbial biomass. Note all of these parameters must be defined in the parms</span>
        <span class="co"># data frame otherwise the problems will occur latter on. </span>
        (<span class="fl">1</span><span class="op">/</span><span class="kw">E.c</span>) <span class="op">*</span> (<span class="kw">V.d</span> <span class="op">+</span> <span class="kw">m.r</span>) <span class="op">*</span> <span class="kw">B</span> <span class="op">*</span> <span class="kw">D</span> <span class="op">/</span>(<span class="kw">K.d</span> <span class="op">+</span> <span class="kw">B</span>)})
  }

      
</pre></div>
<p>Next modify the MEND2013_fluxes with the <code>modify_fluxes_func</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">RMM_carbon_fluxes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/modify_fluxes_func.html">modify_fluxes_func</a></span>(params = <span class="kw">param</span>,
                                        state = <span class="kw">state</span>, 
                                        flux_func = <span class="kw">MEND2013_fluxes</span>,
                                        replace_with = <span class="kw">new_func_list</span>)
</pre></div>
<p>Now solve MEND.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">MEND2013_RMM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solver.html">solver</a></span>(params = <span class="kw">MEND2013_params</span>, 
                           time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1e3</span>, by = <span class="fl">0.1</span>), 
                           state = <span class="kw">state</span>, 
                           carbon_pools_func = <span class="kw">MEND2013_pools</span>,
                           carbon_fluxes_func = <span class="kw">RMM_carbon_fluxes</span>)
</pre></div>
</div>
<div id="compare-results" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-results" class="anchor"></a>Compare Results</h2>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># Add scn column to data frames</span>
<span class="kw">MEND2013_RMM</span><span class="op">$</span><span class="kw">scn</span>     <span class="op">&lt;-</span> <span class="st">'RMM'</span>
<span class="kw">MEND2013_default</span><span class="op">$</span><span class="kw">scn</span> <span class="op">&lt;-</span> <span class="st">'default'</span>

<span class="kw">rslt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="kw">MEND2013_RMM</span>, <span class="kw">MEND2013_default</span>)
</pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(data = <span class="kw">rslt</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">time</span>, <span class="kw">value</span>, color = <span class="kw">scn</span>)) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="st">'variable'</span>, scales = <span class="st">'free'</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()
</pre></div>
<p><img src="MEND2013_change_kinetics_files/figure-html/unnamed-chunk-7-1.png" width="504" height="504" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kalyn Dorheim.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
