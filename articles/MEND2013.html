<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How To: Set up and solve MEND from Wang et al. 2013 • MENDplus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How To: Set up and solve MEND from Wang et al. 2013">
<meta property="og:description" content="MENDplus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MENDplus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/MEND2013.html">How To: Set up and solve MEND from Wang et al. 2013</a>
    </li>
    <li>
      <a href="../articles/MEND2013_change_kinetics.html">How To: Alter MEND 2013 microbial kinetics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MEND2013_files/header-attrs-2.3.1/header-attrs.js"></script><script src="MEND2013_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How To: Set up and solve MEND from Wang et al. 2013</h1>
            
      
      
      <div class="hidden name"><code>MEND2013.Rmd</code></div>

    </div>

    
    
<div id="objective" class="section level2">
<h2 class="hasAnchor">
<a href="#objective" class="anchor"></a>Objective</h2>
<p>The goal of <code>MENDplus</code> is to provide user with a flexible framework that to explore how parametric and structural uncertainty impact mircobical soil carbon dynamics. In this vignette will demonstrate how to set up, solve, and modify the basic MEND documented in <a href="https://doi.org/10.1890/12-0681.1">Wang et al. 2013</a>.</p>
</div>
<div id="about-mend-2013" class="section level2">
<h2 class="hasAnchor">
<a href="#about-mend-2013" class="anchor"></a>About MEND 2013</h2>
<p>Start by setting up the R enviornment.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">MENDplus</span>)   <span class="co"># install with devtools::install_github </span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)    <span class="co"># to make some plots </span>
</pre></div>
<p><br></p>
<p>The 2013 MEND model is a system of differential equations that describe soil carbon dynamics. There are 8 different carbon pools represented as the circles that are connected by 12 arrows, which represent the fluxes between carbon pools.</p>
<p><br></p>
<div class="figure">
<img src="https://esajournals.onlinelibrary.wiley.com/cms/asset/b4cc71bd-8987-4226-8ac1-9e5b6d547af2/eap2013231255-fig-0001-m.jpg" style="width:70.0%" alt=""><p class="caption">Fig 1: conceptual diagram of MEND from Wang et al. 2013</p>
</div>
<p>To use an ode sovler to solve MEND we need, intial state values (the size of the pools) and a table of model parameter values. For this example all of these values are provided by the Wang et. al 2013 documeantion paper.</p>
<div id="a-basic-run" class="section level3">
<h3 class="hasAnchor">
<a href="#a-basic-run" class="anchor"></a>A Basic Run</h3>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Define the size of the different MEND 2013 carbon pools. </span>
<span class="kw">state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(P = <span class="fl">10</span>,  M = <span class="fl">5</span>,  Q = <span class="fl">0.1</span>,  B = <span class="fl">2</span>,  D = <span class="fl">1</span>,  EP = <span class="fl">0.00001</span>, 
           EM = <span class="fl">0.00001</span>,  IC = <span class="fl">0</span>,  Tot = <span class="fl">18.10002</span>)

<span class="co"># Define a table of MEND parameters. # MENDplus containts a dataframe of the default parameter values from Wang et al. 2013.</span>
<span class="kw">param</span> <span class="op">&lt;-</span> <span class="kw">MENDplus</span>::<span class="kw"><a href="../reference/MEND2013_params.html">MEND2013_params</a></span>
</pre></div>
<p>So to solve for the 2013 MEND model configuration use the <code>solver</code> function. The solver function let’s the user define the carbon pools and carbon fluxes, latter on we will demonstrate how to take advantage of this to explore different configurations of MEND.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">MEND2013_example1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solver.html">solver</a></span>(params = <span class="kw">param</span>, 
                           time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1e3</span>, by = <span class="fl">0.1</span>), 
                           state = <span class="kw">state</span>, 
                           carbon_pools_func = <span class="kw">MEND2013_pools</span>, 
                           carbon_fluxes_func = <span class="kw">MEND2013_fluxes</span>)
</pre></div>
<p>Plot the results.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(data = <span class="kw">MEND2013_example1</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">time</span>, <span class="kw">value</span>)) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="st">"variable"</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(title = <span class="st">'Default MEND 2013 Run'</span>, 
       y = <span class="st">"mg C/g soil"</span>)
</pre></div>
<p><img src="MEND2013_files/figure-html/unnamed-chunk-4-1.png" width="504" height="504" style="display: block; margin: auto;"></p>
</div>
<div id="change-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#change-parameters" class="anchor"></a>Change Parameters</h3>
<p>In this example we will change the <code>V.d</code> the max doc uptake for microbial biomass growth. When <code>V.d</code> increases more DOC can be taken up by the microbial biomass, so we would expect the B (microbial biomass pool) to be larger the <code>V.d x 2</code> MEND 2013 simulation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># Make a copy of the default MEND 2013 parameters and doubble the V.d value. </span>
<span class="kw">doubble_Kd</span> <span class="op">&lt;-</span> <span class="kw">MENDplus</span>::<span class="kw"><a href="../reference/MEND2013_params.html">MEND2013_params</a></span>
<span class="kw">doubble_Kd</span>[<span class="kw">parameter</span> <span class="op">==</span> <span class="st">'V.d'</span>, ]<span class="op">$</span><span class="kw">value</span> <span class="op">&lt;-</span> <span class="kw">MENDplus</span>::<span class="kw"><a href="../reference/MEND2013_params.html">MEND2013_params</a></span>[<span class="kw">parameter</span> <span class="op">==</span> <span class="st">'V.d'</span>, <span class="kw">value</span>] <span class="op">*</span> <span class="fl">2</span>

<span class="co"># Now solve the MEND2013 model with the new  parmeters. The only difference between the set up </span>
<span class="co"># for MEND2013_example2 and MEND2013_example1 is the parameter data frame  passed into the solver.</span>
<span class="kw">MEND2013_example2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solver.html">solver</a></span>(params = <span class="kw">doubble_Kd</span>, 
                            time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0</span>, <span class="fl">1e3</span>, by = <span class="fl">0.1</span>), 
                           state = <span class="kw">state</span>, 
                           carbon_pools_func = <span class="kw">MEND2013_pools</span>, 
                           carbon_fluxes_func = <span class="kw">MEND2013_fluxes</span>)
</pre></div>
<p>Compare the two simulations!</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># Add the smilulation names as columns and  combine into a single  data frame for visualization. </span>
<span class="kw">MEND2013_example1</span><span class="op">$</span><span class="kw">scn</span> <span class="op">&lt;-</span> <span class="st">'default'</span>
<span class="kw">MEND2013_example2</span><span class="op">$</span><span class="kw">scn</span> <span class="op">&lt;-</span> <span class="st">'V.d X 2'</span>
<span class="kw">rslt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(<span class="kw">MEND2013_example1</span>, <span class="kw">MEND2013_example2</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(data = <span class="kw">rslt</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">time</span>, <span class="kw">value</span>, color = <span class="kw">scn</span>)) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="st">"variable"</span>, scales = <span class="st">"free"</span>) <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>() <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(title = <span class="st">'Default MEND 2013 Run'</span>, 
       y = <span class="st">"mg C/g soil"</span>)
</pre></div>
<p><img src="MEND2013_files/figure-html/unnamed-chunk-6-1.png" width="504" height="504" style="display: block; margin: auto;"></p>
<p>As we were expecting the biomass pool is larger in the <code>V.d X 2</code> simulation!</p>
<p><br><br><br></p>
<hr>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
<span class="co">#&gt; R version 3.6.3 (2020-02-29)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Mojave 10.14.6</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] ggplot2_3.3.2  MENDplus_0.1.0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] compiler_3.6.3     pillar_1.4.4       tools_3.6.3        digest_0.6.25     </span>
<span class="co">#&gt;  [5] evaluate_0.14      memoise_1.1.0      lifecycle_0.2.0    tibble_3.0.1      </span>
<span class="co">#&gt;  [9] gtable_0.3.0       pkgconfig_2.0.3    rlang_0.4.6        bibtex_0.4.2.2    </span>
<span class="co">#&gt; [13] rstudioapi_0.11    yaml_2.2.1         pkgdown_1.5.1.9000 xfun_0.14         </span>
<span class="co">#&gt; [17] withr_2.2.0        stringr_1.4.0      dplyr_1.0.0        knitr_1.28        </span>
<span class="co">#&gt; [21] desc_1.2.0         generics_0.0.2     fs_1.4.1           vctrs_0.3.1       </span>
<span class="co">#&gt; [25] tidyselect_1.1.0   gbRd_0.4-11        rprojroot_1.3-2    grid_3.6.3        </span>
<span class="co">#&gt; [29] deSolve_1.28       glue_1.4.1         data.table_1.12.8  R6_2.4.1          </span>
<span class="co">#&gt; [33] Rdpack_1.0.0       rmarkdown_2.3.1    farver_2.0.3       purrr_0.3.4       </span>
<span class="co">#&gt; [37] magrittr_1.5       backports_1.1.8    scales_1.1.1       htmltools_0.5.0   </span>
<span class="co">#&gt; [41] ellipsis_0.3.1     assertthat_0.2.1   colorspace_1.4-1   labeling_0.3      </span>
<span class="co">#&gt; [45] stringi_1.4.6      munsell_0.5.0      crayon_1.3.4</span>
</pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kalyn Dorheim.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
